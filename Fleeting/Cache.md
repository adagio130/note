
![[Pasted image 20231221214544.png]]

- Client-side cache
- CDN
	- static content
- Load Balance
- Message Broker
- Relational Database
- Elastic search
- Redis
	- in-memory database
	- 

- **主动失效**：
    - 每当商品价格、库存、描述或图片在数据库中更新时，通过事件触发机制（如消息队列）通知缓存系统，立即失效对应的缓存。
- **延迟双删策略**：
    - 在进行重要数据的更新（如价格和库存）时，执行以下步骤：
        1. 先删除缓存中的旧数据。
        2. 更新数据库中的数据。
        3. 更新完成后，等待一小段时间（比如 50-100 毫秒），然后再次删除缓存。这段时间可以确保在更新操作未完成时，不会出现缓存重建导致不一致的问题。


practice problems:
### 题目 1: 缓存策略设计

设计一个缓存策略来缓存一个电商网站的商品列表。考虑以下要求：

- 商品信息需要经常更新。
- 不同的商品有不同的访问频率。
- 系统需要处理高并发访问。

**问题:**

1. 你会选择哪种缓存类型（内存缓存、分布式缓存等），为什么？
2. 你会如何设置缓存的TTL值？如何处理商品信息更新时的缓存一致性问题？
3. 你会选择什么样的缓存淘汰策略？为什么？

Answer:
1. 目標:
	1. 提高速度
	2. 保持一制性
	3. 高併發支持

2. 決定要緩存什麼
	1. 商品價格及數量
		1. TTL
		2. 一致性
		3. 
	2. 商品圖片及描述
	3. 分類和搜尋結果
		


### 题目 2: 避免缓存雪崩

假设你管理着一个大型的社交媒体平台，并使用缓存机制来加速用户数据的访问。最近你发现了一次缓存雪崩，导致数据库负载剧增。

**问题:**

1. 缓存雪崩的原因可能是什么？
2. 你会采用哪些策略来防止缓存雪崩再次发生？
3. 如何错开缓存的过期时间来避免同一时间大量缓存失效？

### 题目 3: 缓存预加载

你负责维护一个新闻网站，其中有一些“热门新闻”页面需要频繁访问。你决定使用缓存预加载策略来优化这些页面的响应速度。

**问题:**

1. 你会如何实现缓存预加载？在哪些情况下你会触发预加载？
2. 如何处理“热门新闻”变动较快的情况，避免缓存中的数据过时？
3. 如果预加载的数据量较大，如何避免它对系统其他部分的性能造成负面影响？

### 题目 4: 分布式缓存设计

你正在设计一个支持全球用户的实时聊天应用程序。为了提高响应速度，你决定在多个地理位置部署分布式缓存系统。

**问题:**

1. 你会选择哪种分布式缓存工具？为什么？
2. 如何保证不同地理位置的缓存数据一致性？
3. 在分布式环境中如何处理缓存失效和数据更新？

### 题目 5: 实现缓存穿透的防护

你开发的应用程序中出现了缓存穿透问题，导致大量无效请求直接打到数据库，造成性能问题。

**问题:**

1. 缓存穿透的原因是什么？
2. 你会采用哪些技术手段来防止缓存穿透？（如布隆过滤器等）
3. 如果某些请求需要绕过缓存直接访问数据库，如何设计以确保性能不受太大影响？

### 题目 6: 缓存监控和优化

你正在优化一个已经部署的应用程序，该应用使用缓存来提升性能，但你发现缓存的命中率并不高。

**问题:**

1. 如何通过监控工具分析缓存命中率低的原因？
2. 针对不同的低命中率原因，提出可能的优化措施。
3. 如果你发现某些数据总是被频繁访问，但缓存中却没有这些数据，如何调整缓存策略来优化？

### 题目 7: 缓存安全性设计

你的应用程序中缓存了大量的用户敏感数据，如个人信息和支付记录。你需要设计一个缓存机制，确保这些敏感数据的安全性。

**问题:**

1. 你会采取哪些措施来确保缓存中数据的安全？
2. 在数据加密的情况下，如何平衡加密开销和缓存性能？
3. 如果缓存系统被入侵，你会如何设计以最小化数据泄漏的风险？

通过这些题目，你可以更深入地理解缓存机制的各种应用场景，并尝试不同的设计和优化方案。每道题目都提供了一个实际应用中的挑战，帮助你将理论知识转化为实际的开发技能。